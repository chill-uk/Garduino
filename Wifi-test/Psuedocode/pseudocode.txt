Read the EEPROM for the following values:

// MAX17043
BATTERY_CRITICAL_LEVEL = 10%
BATTERY_LOW_LEVEL = 30%

// 
WATERING_ENABLED = TRUE
NTPCLIENT_UPDATE = FALSE

// Mositure sensor
MOISTURE_SENSOR_BROKEN_LEVEL = 20
MOISTURE_LOW_LEVEL = 300
MOISTURE_TARGET_LEVEL = 400
WATER_LEVEL_LOW = FALSE

T = 0

NodeMCU wakes from either: 
    * First power on (settings are blank)
    * Reset button is pressed
    * EXTRTC wake-up
Wifi module is OFF

Read WATER_LEVEL sensor
    if WATER_LEVEL_LOW = TRUE
        WATERING_ENABLED = FALSE
        WATER_LEVEL NOTIFICATION = 'Water level is low"
T = 1   (Battery sensor = MAX17043)

Wake Battery sensor
Read Battery sensor
Sleep Battery sensor
    if BATTERY_LEVEL <= BATTERY_LOW_LEVEL
        BATTERY_NOTIFICATION = "battery level is LOW"
        SET WATERING_ENABLED = FALSE // Just in monitoring mode
    if BATTERY_LEVEL <= BATTERY_CRITICAL_LEVEL
        BATTERY_NOTIFICATION = "Battery level is CRITICAL"

T = 2 (EXTRTC = DS3231)

Read EXTRTC
    if time between 10pm and 6am
        SET WATERING_ENABLED = FALSE
    if time is 00:00 on the 1st of the month
        NTPCLIENT_UPDATE = TRUE

T = 3 (LUX = BH1750)

Wake LUX sensor
Read LUX sensor
Sleep LUX sensor

T = 4 (TEMP = BME280)

Wake TEMP sensor
Read TEMP sensor
    Temp / Humidity / Pressure
Sleep TEMP sensor

T = 5 (Mositure sesnor - for multiple pumps, re-read the WATER_LEVEL_LOW sensor each time)

Wake Mositure sensor (A/B)
Read Mositure sensor (A/B)
    if MOISTURE_LEVEL (A/B) <= MOISTURE_SENSOR_BROKEN_LEVEL
        MOISTURE_NOTIFICATION = "Mosite sensor (A/B) is broken or disconnected"
        SET WATERING_ENABLED (A/B) = FALSE
    if MOISTURE_LEVEL (A/B) <= MOISTURE_LOW_LEVEL && WATERING_ENABLED (A/B)= TRUE
        Enable Water_Pump (A/B)
        End_time = Get_Sys_time + 10 seconds
        While ((MOISTURE_LEVEL (A/B) < MOISTURE_TARGET_LEVEL) && (Get_Sys_time < End_time))
            Read Mositure sensor (A/B)
            Delay(250)
        MOISTURE_NOTIFICATION = "Plants (A/B) have been watered"
    else
        MOISTURE_NOTIFICATION = "Plants aren't being watered.
Sleep Mositure sensor

T = 6 (If time = XX:00) [on the hour]

Wake Wifi
Connect to AP via DHCP
Upload results (thingspeak and twitter)
    [FLOAT] MOISTURE_LEVEL
    [STRING] MOISTURE_NOTIFICATION
    [FLOAT] BATTERY_LEVEL
    [STRING] BATTERY_NOTIFICATION
    [INT] LUX
    [FLOAT] TEMP/HUMIDITY/PRESSURE
    [BOOL] WATERING_ENABLED (TRUE/FALSE)
    [BOOL] WATER_LEVEL_LOW (TRUE/FALSE)

else
    Store results in EEPROM

T = 7 (Updte EXT.RTC - if needed)

if NTPCLIENT_UPDATE = TRUE 
    Sync EXT.RTC from NTP pool.

T = 8 (Read weather forecast - if configured)

Read OpenWeathermapAPI
    Check weather for next 3 hours
    if rainfall => X
        WATERING_ENABLED = FALSE >> Save to internal storage
    if rainfall < X
        WATERING_ENABLED = TRUE >> Save to internal storage

T = 9

Disconnect Wifi
Disable Wifi
Disable Alive pin.